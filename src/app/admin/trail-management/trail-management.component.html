<div class="container my-4">
    <app-loading-spinner *ngIf="isLoading"></app-loading-spinner>
    <div *ngIf="savedTrailCode">
        <div class="space-up alert alert-success" role="alert">
            Sentiero {{ savedTrailCode }} aggiunto
        </div>
    </div>

    <div *ngIf="!isLoading && selectedTrail != null">
        <app-trail-floating-preview
                [trails]="[selectedTrail]"
                [isVisible]="isPreviewVisible"
                (onClose)="togglePreview()"
        ></app-trail-floating-preview>
    </div>

    <div class="row section-distance-up">
        <div class="col-12 col-md-12">
            <h1>Gestione Sentieri</h1>
            <h2>Lista Sentieri</h2>
            <div *ngIf="trailPreviewList && trailPreviewList.length > 0 else notShow">
                <table id="trailTable" class="table table-striped interactive-table">
                    <thead class="">
                    <tr>
                        <th scope="col">Id</th>
                        <th scope="col">Codice</th>
                        <th scope="col">Stato</th>
                        <th scope="col">Localita</th>
                        <th scope="col">Cl.</th>
                        <th scope="col">Ciclo</th>
                        <th scope="col">C. da Utente</th>
                        <th scope="col">+ Ciclo</th>
                        <th scope="col">Modifica</th>
                        <th scope="col">Cancella</th>
                    </tr>
                    </thead>
                    <tbody class="short-list">
                    <tr
                            *ngFor="let trailPreview of trailPreviewList"
                            class="trailPreview"
                            (click)="onPreview(trailPreview)"
                    >
                        <th
                                scope="row"
                                class="ellipsis small-column"
                                title="{{ trailPreview.id }}"
                        >
                            {{ trailPreview.id }}
                        </th>

                        <td>
                            <span class="trailCodeColumn">{{ trailPreview.code }}</span>
                        </td>
                        <td>
                            {{
                            trailPreview.trailStatus == "PUBLIC" ? "Pubblicato" : "Bozza"
                            }}
                        </td>
                        <td>
                            {{ trailPreview.startPos.name }} -
                            {{ trailPreview.finalPos.name }}
                        </td>
                        <td>{{ trailPreview.classification }}</td>
                        <td class="clickable">
                            {{ trailPreview.bikeData ? "Si" : "No" }}
                        </td>
                        <td class="clickable">
                            {{ trailPreview.fileDetails.uploadedBy }}
                        </td>
                        <td
                                class="clickable"
                                routerLink="/admin/trail/cyclo/{{ trailPreview.id }}"
                        >
                            <svg class="bi" width="32" height="32" fill="currentColor">
                                <use
                                        xlink:href="/assets/bootstrap-icons/bootstrap-icons.svg#bicycle"
                                />
                            </svg>
                        </td>
                        <td
                                class="clickable"
                                routerLink="/admin/trails/edit/{{ trailPreview.id }}"
                        >
                            <svg class="bi" width="24" height="24" fill="currentColor">
                                <use
                                        xlink:href="/assets/bootstrap-icons/bootstrap-icons.svg#pen"
                                />
                            </svg>
                        </td>
                        <td class="clickable" (click)="onDelete($event, trailPreview)">
                            <svg class="bi" width="32" height="32" fill="currentColor">
                                <use
                                        xlink:href="/assets/bootstrap-icons/bootstrap-icons.svg#trash"
                                />
                            </svg>
                        </td>
                    </tr>
                    </tbody>
                </table>
                <div class="pagination-position">
                    <ngb-pagination
                            [pageSize]="entryPerPage"
                            [collectionSize]="totalTrail"
                            [(page)]="page"
                            aria-label="Default pagination"
                            (pageChange)="loadTrails(page)"
                    ></ngb-pagination>
                </div>
            </div>
            <ng-template #notShow>
                <app-items-not-found
                        text="Nessun sentiero trovato. Creano uno caricando una traccia"></app-items-not-found>
            </ng-template>
        </div>
    </div>
</div>
